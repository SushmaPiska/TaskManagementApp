  "title":"task222662",
  "priority":"high",
  "assignee":"ss",
  "checkList":{"check1":true,"check2":false},
  "dueDate":"2024-10-22"

  {

 "email":"scxx@x.com",
 "password":"password"
}
/////////////////////////package.json////////////////
"scripts":"npm install && npm install --prefix frontend && npm run build --prefix frontend"
"start":"node backend/server.js",
/////////////////
chatgpt//
-----------
  "test": "echo \"Error: no test specified\" && exit 1",
    "start": "concurrently \"npm run start --prefix frontend\" \"nodemon backend/server.js\"",
    "build": "cd frontend && npm run build",
    "server": "nodemon backend/server.js",
    "dev": "cd frontend && npm run dev"

/////////////////////////////
/////registerPage
// import { useState } from "react";
// import Form from "./Form.jsx";
// import axios from "axios";
// import { useNavigate } from "react-router-dom";
// import styles from "./Register.module.css";
// export default function Register() {
//   console.log(styles)
//   const navigate = useNavigate();

//   const token=localStorage.getItem("token");
//   if(token) {
//     console.log("token: " + token);
//     navigate("/dashboard");
//   }
//   const [formData, setFormData] = useState({
//     name: "",
//     email: "",
//     password: "",
//     confirmPassword: "",
//   });
//   const [error, setError] = useState({
//     name: false,
//     email: false,
//     password: false,
//     confirmPassword: false,
//   });
//   const formFields = [
//     {
//       name: "name",
//       type: "text",
//       placeholder: "Name",
//       value: formData.name,
//       className: styles.inputItem,
//       onChange: (e) => {
//         setFormData({ ...formData, name: e.target.value });
//       },
//     },
//     {
//       name: "email",
//       type: "email",
//       placeholder: "Email",
//       value: formData.email,
//       className: styles.inputItem,
//       onChange: (e) => {
//         setFormData({ ...formData, email: e.target.value });
//       },
//     },
//     {
//       name: "password",
//       type: "password",
//       placeholder: "Password",
//       value: formData.password,
//       className: styles.inputItem,
//       onChange: (e) => {
//         setFormData({ ...formData, password: e.target.value });
//       },
//     },
//     {
//       name: "confirmPassword",
//       type: "password",
//       placeholder: "Confirm Password",
//       value: formData.confirmPassword,
//       className: styles.inputItem,
//       onChange: (e) => {
//         setFormData({ ...formData, confirmPassword: e.target.value });
//       },
//     },
//   ];

//   console.log(error);

//   const errorMessages = {
//     name: {
//       message: "Name is required",
//       isValid: formData.name.length > 0,
//       onError: () => {
//         setError((error) => ({ ...error, name: true }));
//       },
//     },
//     email: {
//       message: "Email is required",
//       isValid: formData.email.length > 0,
//       onError: () => {
//         setError((error) => ({ ...error, email: true }));
//       },
//     },
//     password: {
//       message: "Password is required",
//       isValid: formData.password.length > 0,
//       onError: () => {
//         setError((error) => ({ ...error, password: true }));
//       },
//     },
//     confirmPassword: {
//       message: "Passwords do not match",
//       isValid: formData.confirmPassword === formData.password,
//       onError: () => {
//         setError((error) => ({ ...error, confirmPassword: true }));
//       },
//     },
//   };
//   const onSubmit = async (e) => {
//     e.preventDefault();
//     let isError = false;

//     Object.keys(errorMessages).forEach((key) => {
//       if (!errorMessages[key].isValid) {
//         isError = true;
//         errorMessages[key].onError();
//       }
//     });

//     if (!isError) {
//       axios
//         .post("http://localhost:8000/api/auth/signup", {
//           name: formData.name,
//           email: formData.email,
//           password: formData.password,
//           confirmPassword: formData.confirmPassword,
//         })
//         .then((response) => {
//           // if(response.data.status){
//           navigate("/login");
//           console.log("registered successfully");
//           // }
//         })
//         .catch((error) => {
//           console.log(error);
//         });
//     }
//   };

//   return (
//     <div className={styles.inputFields}>
//       <h1>Register</h1>
//       <Form
//         error={error}
//         formFields={formFields}
//         onSubmit={onSubmit}
//         errorMessages={errorMessages}

//       />
//     </div>
//   );
// }
///////////////////////////
import React, { useState, useRef } from "react";
import Popup from "reactjs-popup";
import "reactjs-popup/dist/index.css";
import styles from "./TaskCard.module.css";
import dots from "../assets/3dots.png";
import upArrow from "../assets/upArrow.png";
import downArrow from "../assets/downArrow.png";
import { formatDate } from "../../helper/formatDate";
import { getShortForm } from "../../helper/getShortForm";
import DeletePopup from "./DeletePopup";

function TaskCard({ title, priority, assignee, checkList, dueDate, taskType }) {
  const [isOpen, setIsOpen] = useState(false);
  const [isMenuOpen, setIsMenuOpen] = useState(false);

  const popupRef = useRef();

  const checkListToggle = () => {
    setIsOpen(!isOpen);
  };
  const menuToggle = () => {
    setIsMenuOpen(!isMenuOpen);
  };

  const [isDeletePopupOpen, setDeletePopupOpen] = useState(false);

  const openDeletePopup = () => {
    menuToggle(); // Close the menu
    setDeletePopupOpen(true); // Open the delete popup
  };

  const closeDeletePopup = () => {
    setDeletePopupOpen(false); // Close the delete popup
  };

  let priorityClass;
  let dueDateClass;
  if (priority === "high") {
    priorityClass = styles.high;
    dueDateClass = styles.redDate;
  } else if (priority === "moderate") {
    priorityClass = styles.moderate;
    dueDateClass = styles.dueDate;
  } else {
    priorityClass = styles.low;
    dueDateClass = styles.dueDate;
  }

  let switchArray = ["BACKLOG", "PROGRESS", "DONE"];

  return (
    <div className={styles.container}>
      <div className={styles.cardNav}>
        <div className={priorityClass}></div>
        <div className={styles.priorityText}>
          {priority.toUpperCase()} PRIORITY
        </div>
        <div className={styles.assignee}>{getShortForm(assignee)}</div>
        <img
          src={dots}
          alt=""
          onClick={menuToggle}
          className={styles.menuIcon}
        />
      </div>
      {isMenuOpen && (
        <div className={styles.menu}>
          <ul>
            <li className={styles.menuItem} onClick={menuToggle}>
              Edit
            </li>
            <li className={styles.menuItem} onClick={menuToggle}>
              Share
            </li>

            <li
              className={`${styles.delete} ${styles.menuItem}`}
              onClick={openDeletePopup}
            >
              Delete
            </li>

            {/* <Popup
              open={isDeletePopupOpen}
              onClose={closeDeletePopup}
              modal
              nested
              className={styles.popup}
              contentStyle={{ width: "30%" }}
            >
              <DeletePopup closePopup={closeDeletePopup} />
            </Popup> */}

            <Popup
              className={styles.popup}
              contentStyle={{ width: "30%" }}
              trigger={<li className={styles.delete + " " + styles.menuItem} onClick={menuToggle}>Delete</li>}
              modal
              nested
              ref={popupRef}
              
            >
              {(close) => <DeletePopup closePopup={()=>{
                close()
                menuToggle()
              }} />}
              
            </Popup>
          </ul>
        </div>
      )}
      <div className={styles.title}>{title}</div>
      <div className={styles.checkList}>
        <div className={styles.checkListHead}>
          <p>Checklist(0/3)</p>
          <img
            src={isOpen ? upArrow : downArrow}
            onClick={checkListToggle}
            className={styles.arrowIcon}
          />
        </div>
        {isOpen && (
          <ul>
            {Object.entries(checkList).map(([key, value]) => (
              <li key={key} className={styles.checkItem}>
                <input
                  type="checkbox"
                  checked={value}
                  className={styles.checkbox}
                />
                {key}
              </li>
            ))}
          </ul>
        )}
      </div>
      <div className={styles.footer}>
        <div className={dueDateClass}>{formatDate(dueDate)}</div>
        {switchArray.map((item, index) => (
          <div key={index} className={styles.footItem}>
            {item}
          </div>
        ))}
      </div>
    </div>
  );
}

export default TaskCard;
///////////////////////